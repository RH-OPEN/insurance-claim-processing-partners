= Sanity-Check Pipeline
include::_attributes.adoc[]

== パイプラインは何をしますか?
すべてが期待どおりに機能し、モデルが改ざんされていないことを確認するために、エンドポイントを通じてモデルをテストするサニティ チェック パイプラインを作成します。 +
応答の品質をテストします。チェックすべきことは他にもありますが。 +
時間が経っても変わらないことを確認するために、そのパイプラインをスケジュールします。

== サニティ チェック パイプラインをデプロイする

`insurance-claim-processing-partners/lab-materials/03/06` フォルダーには、`sanity_check.pipeline` ファイルと `sanity_check.yaml` ファイルの 2 つのパイプライン ファイルがあります。

`.pipeline` ファイルは Elyra で開いて視覚的に変更および実行できますが、`.yaml` ファイルは RHOAI ダッシュボードを通じてパイプライン サーバーにインポートできます。 +
ここでは、Elyra を通じてパイプラインを実行します。

== アドホック実行

Elyra で実行すると、パイプラインをインポートして自動的に実行するのではなく、パイプラインをアドホック実行するのと同じになります。

. 実行中のワークベンチに移動して開始します
. フォルダー `insurance-claim-processing-partners/lab-materials/03/06` に移動します
. `sanity_check.pipeline` ファイルを開きます
. ここで、パイプラインが 3 つのチェックで構成されていることがわかります:
.. 応答品質チェック
.. 応答時間チェック
.. セキュリティ チェック
. ノードをダブルクリックして各 Python ファイルを自由に覗いて、その動作を確認してください。 +
. テストの実行後、結果を要約してログに記録する最終関数があります。
. パイプラインを実行するには、メニュー バーの [再生] ボタンを押します。
+
[.bordershadow]
image::03/07-elyra-pipeline.png[elyra sanity pipeline]
.ポップアップで、名前を変更せずに [**OK**] をクリックします:
+
[.bordershadow]
image::03/03-07-run-pipeline-ok.png[]

. **Data Science Pipelines へのジョブの送信が成功しました** というポップアップが表示されたら、[**実行の詳細**] リンクをクリックして、パイプラインの進行状況を確認します。

== 実行のスケジュール

実行を **スケジュール** して、定期的にサニティ チェックを実行することもできます。 +
これを行うには:

. OpenShift AI Data Science プロジェクトに戻ります
. 実行したパイプラインを見つけます
. 行の末尾にある 3 つのドットをクリックし、[実行の作成] をクリックします。
+
[.bordershadow]
image::03/07-create-run.png[実行の作成]

.次の画面で、名前を選択し、**日**ごとにトリガーする定期実行を選択して、**作成**をクリックします:
+
[.bordershadow]
image::03/03-06-dailyrun.png[]

. これで、サニティチェック パイプラインはそのままにしておくことができます。
. 毎日実行され、LLM に問題が発生した場合に通知されます。
